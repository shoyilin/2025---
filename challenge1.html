<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>挑戰一：排列反應物</title>
    <!-- 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: none; /* 禁用頁面滾動以便拖曳 */
        }
        .draggable {
            touch-action: none;
            cursor: grab;
        }
        .draggable:active {
            cursor: grabbing;
        }
        .drop-zone {
            min-height: 60px; /* 確保有足夠高度 */
            min-width: 120px; /* 確保有足夠寬度 */
            transition: background-color 0.2s;
        }
        .drop-zone.drag-over {
            background-color: #dbeafe; /* blue-100 */
            border-style: dashed;
        }
        .drag-item-container {
            min-height: 70px; /* 確保容器有高度 */
        }
    </style>
</head>
<body class="bg-blue-50 min-h-screen flex flex-col items-center justify-center p-4">

    <!-- 標題 -->
    <h1 class="text-3xl sm:text-4xl font-bold text-blue-900 mb-8 text-center">
        挑戰一：排列化學反應式的原料與產物
    </h1>

    <!-- 內容容器 -->
    <div class="bg-white p-8 sm:p-12 rounded-2xl shadow-lg max-w-4xl w-full">

        <!-- 上半部：方程式 -->
        <div class="mb-12">
            <h2 class="text-xl font-semibold text-gray-700 text-center mb-6">將下方的方塊拖曳到正確的空格中：</h2>
            <div class="flex flex-wrap items-center justify-center text-2xl sm:text-3xl font-bold text-blue-800 gap-4">
                <!-- 空格 1 -->
                <div id="drop-zone-1" class="drop-zone bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex items-center justify-center" data-answer-id="1"></div>
                <span>+</span>
                <!-- 空格 2 -->
                <div id="drop-zone-2" class="drop-zone bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex items-center justify-center" data-answer-id="2"></div>
                <span class="text-4xl text-green-600">&rarr;</span>
                <!-- 空格 3 -->
                <div id="drop-zone-3" class="drop-zone bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex items-center justify-center" data-answer-id="3"></div>
                <span>+</span>
                <!-- 空格 4 -->
                <div id="drop-zone-4" class="drop-zone bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex items-center justify-center" data-answer-id="4"></div>
            </div>
        </div>

        <hr class="my-8 border-gray-300">

        <!-- 下半部：可拖曳的選項 -->
        <div>
            <h3 class="text-lg font-semibold text-gray-700 text-center mb-4">可用的原料與產物：</h3>
            <div id="drag-container" class="drag-item-container flex flex-wrap justify-center gap-4 p-4 bg-gray-50 rounded-lg">
                <div id="drag-co2" class="draggable bg-green-200 text-green-900 p-4 rounded-lg shadow-sm font-semibold" draggable="true" data-text="二氧化碳">二氧化碳</div>
                <div id="drag-water" class="draggable bg-blue-200 text-blue-900 p-4 rounded-lg shadow-sm font-semibold" draggable="true" data-text="水">水</div>
                <div id="drag-glucose" class="draggable bg-yellow-200 text-yellow-900 p-4 rounded-lg shadow-sm font-semibold" draggable="true" data-text="葡萄糖">葡萄糖</div>
                <div id="drag-oxygen" class="draggable bg-indigo-200 text-indigo-900 p-4 rounded-lg shadow-sm font-semibold" draggable="true" data-text="氧氣">氧氣</div>
            </div>
        </div>

        <!-- 按鈕區域 -->
        <div class="mt-10 flex flex-wrap justify-center gap-4">
            <button id="reset-button" class="bg-yellow-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-yellow-600 transition-colors">
                重設
            </button>
            <button id="check-button" class="bg-green-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-600 transition-colors">
                檢查答案
            </button>
        </div>

        <!-- 訊息提示框 -->
        <div id="message-box" class="mt-6 text-center text-xl font-semibold hidden"></div>

        <!-- 導覽連結 (更新) -->
        <div class="mt-12 flex justify-between items-center">
            <a href="./index.html" class="text-gray-600 hover:text-gray-800 font-medium py-2 px-4 rounded-lg hover:bg-gray-100 transition-colors">
                &larr; 返回首頁
            </a>
            <a href="./challenge2.html" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-colors shadow-md">
                前往下一個挑戰 &rarr;
            </a>
        </div>

    </div> <!-- 內容容器結束 -->

    <script>
        // 拖曳功能相關的 JavaScript
        const draggables = document.querySelectorAll('.draggable');
        const dropZones = document.querySelectorAll('.drop-zone');
        const dragContainer = document.getElementById('drag-container');
        let draggedItem = null;

        // 紀錄每個放置區的原始狀態
        const originalDropZones = {};
        dropZones.forEach(zone => {
            originalDropZones[zone.id] = zone.innerHTML;
        });
        // 紀錄可拖曳選項的原始容器
        const originalDraggableContainer = dragContainer.innerHTML;

        // 拖曳事件監聽
        draggables.forEach(item => {
            item.addEventListener('dragstart', (e) => {
                draggedItem = e.target;
                e.dataTransfer.setData('text/plain', e.target.id);
                setTimeout(() => item.classList.add('hidden'), 0); // 拖曳時隱藏原項目
            });

            item.addEventListener('dragend', () => {
                draggedItem.classList.remove('hidden'); // 放開時顯示
                draggedItem = null;
            });
        });

        // 放置區事件監聽
        dropZones.forEach(zone => {
            zone.addEventListener('dragover', (e) => {
                e.preventDefault(); // 允許放置
                zone.classList.add('drag-over');
            });

            zone.addEventListener('dragleave', () => {
                zone.classList.remove('drag-over');
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('drag-over');

                if (!draggedItem) return;

                // 如果放置區已有項目，將其移回下方容器
                if (zone.children.length > 0) {
                    dragContainer.appendChild(zone.firstElementChild);
                }

                // 將拖曳的項目放入放置區
                draggedItem.classList.remove('hidden'); // 確保項目可見
                zone.appendChild(draggedItem);
            });
        });

        // 讓項目可以被拖回下方容器
        dragContainer.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.target.classList.add('drag-over');
        });
        dragContainer.addEventListener('dragleave', (e) => {
            e.target.classList.remove('drag-over');
        });
        dragContainer.addEventListener('drop', (e) => {
            e.preventDefault();
            e.target.classList.remove('drag-over');
            if (draggedItem) {
                dragContainer.appendChild(draggedItem);
            }
        });


        // 檢查和重設按鈕
        const checkButton = document.getElementById('check-button');
        const resetButton = document.getElementById('reset-button');
        const messageBox = document.getElementById('message-box');

        // 檢查答案
        checkButton.addEventListener('click', () => {
            const zone1 = document.getElementById('drop-zone-1').firstElementChild?.dataset.text;
            const zone2 = document.getElementById('drop-zone-2').firstElementChild?.dataset.text;
            const zone3 = document.getElementById('drop-zone-3').firstElementChild?.dataset.text;
            const zone4 = document.getElementById('drop-zone-4').firstElementChild?.dataset.text;

            // 檢查原料 (葡萄糖, 氧氣)
            const reactants = [zone1, zone2].sort();
            const correctReactants = ["葡萄糖", "氧氣"].sort();

            // 檢查產物 (二氧化碳, 水)
            const products = [zone3, zone4].sort();
            const correctProducts = ["二氧化碳", "水"].sort();

            let isCorrect = (reactants[0] === correctReactants[0] && reactants[1] === correctReactants[1]) &&
                            (products[0] === correctProducts[0] && products[1] === correctProducts[1]);

            messageBox.classList.remove('hidden');
            if (isCorrect) {
                messageBox.textContent = '恭喜你，答案完全正確！';
                messageBox.classList.remove('text-red-600');
                messageBox.classList.add('text-green-600');
            } else {
                messageBox.textContent = '噢，答案有些錯誤，請再試一次！';
                messageBox.classList.remove('text-green-600');
                messageBox.classList.add('text-red-600');
            }
        });

        // 重設
        resetButton.addEventListener('click', () => {
            // 清空放置區並放回可拖曳項目
            dropZones.forEach(zone => {
                if (zone.children.length > 0) {
                    dragContainer.appendChild(zone.firstElementChild);
                }
            });

            // 隱藏訊息
            messageBox.classList.add('hidden');
            messageBox.textContent = '';
        });

    </script>
</body>
</html>


